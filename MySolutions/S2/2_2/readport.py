import csv


def read_portfolio(filename):
    portfolio = []
    with open(filename) as f:
        rows = csv.reader(f)
        _ = next(rows)
        for row in rows:
            record = {"name": row[0], "shares": int(row[1]), "price": float(row[2])}
            portfolio.append(record)
    return portfolio


"""
1)
>>> route_names = {r["route"] for r in rows}
>>> len(route_names)
181

2)
>>> sum([r["rides"] for r in rows if r["date"]=="02/02/2011" and r["route"]=="22"])
5055

3)
>>> from collections import Counter
>>> ctr = Counter()
>>> for row in rows:
...     ctr[row["route"]] += row["rides"]
...     
>>> ctr
Counter({'79': 133796763, '9': 117923787, '49': 95915008, '4': 95309438, '66': 93053461, '151': 89524268, '22': 89380790, '3'
: 89211071, '77': 88484043, '53': 86884085, '20': 86679321, '63': 86609336, '8': 84362672, '82': 74427970, '36': 68780696, '7
2': 66184985, '87': 65522213, '29': 65048709, '81': 59612673, '67': 57880229, '62': 53418231, '60': 52860939, '55': 52724358,
 '6': 52654473, '147': 52379267, '56': 52280435, '74': 52111931, '80': 51543475, '12': 51168351, '52': 49851059, '85': 497768
12, '54': 47976060, '76': 47452382, '47': 44111483, '70': 42640960, '146': 42089695, '71': 41754367, '14': 41094492, '152': 4
0352452, '94': 39817262, '78': 35433146, '21': 35216129, '50': 34166525, '126': 33268789, '28': 33033639, '75': 32597029, '91
': 32296856, '53A': 31898628, '92': 29983360, '155': 29450367, '156': 28882051, '65': 28161390, '15': 26149468, '34': 2570923
9, '145': 25428790, 'X49': 24110395, '119': 24028072, '111': 23663300, '35': 22291648, '44': 22004694, '73': 21639876, '95E':
 21582109, '52A': 21178110, '49B': 20997838, '7': 20243195, '90': 20101625, '95W': 19915671, '54B': 18198815, '84': 16305261,
 '11': 16060502, '8A': 15512245, '97': 14790421, '103': 13649517, '59': 13638703, '30': 13245844, '112': 12701781, '1': 12380
996, '24': 12324872, '157': 12044995, '57': 11526282, '51': 11434393, '93': 11126570, '135': 10639369, 'X9': 9727671, '18': 8
788532, '108': 7958095, '106': 7660770, '125': 7472645, '63W': 7344219, '86': 7186914, '2': 7079897, 'X80': 7076090, 'X28': 7
073855, '136': 6726484, '81W': 6662813, '26': 6655877, '134': 6577698, '39': 6410389, '201': 6087210, '88': 6057455, '43': 59
96263, '68': 5630989, '121': 4986698, 'X54': 4942098, '148': 4920748, 'X55': 4848920, '124': 4770015, '171': 4744053, '62H': 
4668296, '27': 4588654, '172': 4508251, '120': 4389068, '37': 3965341, '54A': 3673818, '48': 3669229, '1001': 3447912, '96': 
3343405, '85A': 3275028, '100': 3146418, 'J14': 3073437, '143': 3047504, '129': 2937283, '205': 2721818, '55N': 2622561, '144
': 2581625, '10': 2486917, 'X4': 2439238, '56A': 2410058, '123': 2241706, 'X3': 2225982, '206': 2190873, '122': 2075144, '33'
: 2011513, 'X20': 1980920, '49A': 1882331, '127': 1684356, '17': 1535165, '38': 1500952, '192': 1387081, '90N': 1360211, '69'
: 1308483, '169': 1282996, '5': 1224396, '170': 1001109, 'R95': 972858, '203': 968082, '204': 916940, '130': 814952, 'X98': 7
94267, '115': 773755, '53AL': 664698, '25': 632161, 'R63': 629465, '154': 617888, '64': 599089, '19': 566505, '132': 522313, 
'X21': 496415, '173': 443496, '55A': 417388, 'R79': 345494, '174': 302560, 'R22': 279556, '202': 276827, 'R87': 269043, '200'
: 234800, '128': 176670, '168': 164912, 'R69': 158023, '165': 140129, '1002': 108109, '69BR': 85938, 'R55': 69200, 'X99': 540
99, 'N201': 44750, '40': 38447, '137': 25617, '290S': 7308, '290': 4440, '95': 2313, 'R39': 398})
>>> ctr.most_common(5)
[('79', 133796763), ('9', 117923787), ('49', 95915008), ('4', 95309438), ('66', 93053461)]

4)
>>> ctr01 = Counter()
>>> for row in rows:
...     if row["date"].endswith("2001"):
...         ctr01[row["route"]] += row["rides"]
>>> ctr11 = Counter()
>>> for row in rows:
...     if row["date"].endswith("2011"):
...         ctr11[row["route"]] += row["rides"]
...         
>>> ctr_delta = ctr01 - ctr11
>>> ctr_delta = ctr11 - ctr01
>>> ctr_delta.most_common(5)
[('15', 2732209), ('147', 2107910), ('66', 1612958), ('12', 1612067), ('14', 1351308)]



"""
